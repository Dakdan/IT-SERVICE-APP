<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IT Service UDON</title>

<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">

<style>
body{
    margin:0;
    font-family:'Kanit',sans-serif;
    background: linear-gradient(to bottom,#ffe6f0,#ffffff);
}
header{
    background:#fff;
    padding:15px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    box-shadow:0 2px 5px rgba(0,0,0,0.1);
}
.logo{
    display:flex;
    align-items:center;
}
.logo img{
    height:60px;
    margin-right:15px;
}
.title h2{
    margin:0;
    color:#d81b60;
}
.userbox{
    text-align:right;
}
button{
    background:#d81b60;
    color:#fff;
    border:none;
    padding:8px 14px;
    border-radius:6px;
    cursor:pointer;
}
button:hover{
    opacity:0.9;
}
.tabs{
    display:flex;
    background:#f8bbd0;
}
.tabs button{
    flex:1;
    background:none;
    color:#000;
    font-weight:600;
}
.tabcontent{
    display:none;
    padding:20px;
}
.active{
    display:block;
}
table{
    width:100%;
    border-collapse:collapse;
}
th,td{
    border:1px solid #eee;
    padding:8px;
    font-size:14px;
}
th{
    background:#fce4ec;
}
.overlay{
    position:fixed;
    top:0;left:0;
    width:100%;
    height:100%;
    background:rgba(0,0,0,0.4);
    display:none;
    align-items:center;
    justify-content:center;
    z-index:1000;
}
.modal{
    background:#fff;
    padding:20px;
    border-radius:10px;
    width:90%;
    max-width:400px;
}
.login-container{
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}
.login-box{
    background:#fff;
    padding:30px;
    border-radius:10px;
    width:350px;
}
input{
    width:100%;
    padding:8px;
    margin:6px 0;
}
.watermark{
    position:fixed;
    bottom:10px;
    right:10px;
    opacity:0.05;
    font-size:60px;
}
</style>
</head>
<body>

<div id="loginPage" class="login-container">
<div class="login-box">
<h3>Login</h3>
<input id="loginUser" placeholder="UserPn">
<input id="loginPass" type="password" placeholder="Password">
<button onclick="login()">Login</button>
<button onclick="showReset()">ลืมรหัสผ่าน</button>
</div>
</div>

<div id="mainPage" style="display:none;">
<header>
<div class="logo">
<img src="https://img2.pic.in.th/-227e4f6f84f29f020.png">
<div class="title">
<h2>โรงพยาบาลอุดรธานี</h2>
<div>กลุ่มงานเทคโนโลยีสารสนเทศ<br>ระบบจัดการงานบริการและซ่อมอุปกรณ์คอมพิวเตอร์</div>
</div>
</div>
<div class="userbox">
<div id="userInfo"></div>
<button onclick="logout()">Logout</button>
</div>
</header>

<div class="tabs">
<button onclick="openTab('tab1')">Dashboard</button>
<button onclick="openTab('tab2')">My Job</button>
<button onclick="openTab('tab3')">LinkID</button>
</div>

<div id="tab1" class="tabcontent active">
<h3>Dashboard</h3>
<div id="dashboardSummary"></div>
<table id="jobTable"></table>
</div>

<div id="tab2" class="tabcontent">
<h3>My Job</h3>
<div id="myJobList"></div>
</div>

<div id="tab3" class="tabcontent">
<h3>System Link</h3>
<div id="systemLinks"></div>
</div>

<div class="watermark">IT UDON HOSP</div>
</div>

<div id="overlay" class="overlay">
<div class="modal" id="modalContent"></div>
</div>

<script>
const API_URL="PUT_YOUR_WEBAPP_URL_HERE";

function showOverlay(msg){
    document.getElementById("modalContent").innerHTML=msg;
    document.getElementById("overlay").style.display="flex";
}
function closeOverlay(){
    document.getElementById("overlay").style.display="none";
}
document.getElementById("overlay").onclick=closeOverlay;

function openTab(tab){
    document.querySelectorAll('.tabcontent').forEach(t=>t.classList.remove('active'));
    document.getElementById(tab).classList.add('active');
}

function login(){
    const user=document.getElementById("loginUser").value;
    const pass=document.getElementById("loginPass").value;
    showOverlay("กำลังตรวจสอบ...");
    fetch(API_URL,{
        method:"POST",
        body:JSON.stringify({
            action:"login",
            user:user,
            pass:pass
        })
    }).then(r=>r.json()).then(res=>{
        closeOverlay();
        if(res.success){
            sessionStorage.setItem("user",JSON.stringify(res.data));
            loadMain();
        }else{
            showOverlay("Login ไม่สำเร็จ");
        }
    });
}

function logout(){
    sessionStorage.clear();
    location.reload();
}

function loadMain(){
    document.getElementById("loginPage").style.display="none";
    document.getElementById("mainPage").style.display="block";
    const user=JSON.parse(sessionStorage.getItem("user"));
    document.getElementById("userInfo").innerHTML=user.UserName;
    loadDashboard();
}

function loadDashboard(){
    fetch(API_URL,{
        method:"POST",
        body:JSON.stringify({action:"getJobs"})
    }).then(r=>r.json()).then(res=>{
        if(res.success){
            let html="<tr><th>JobID</th><th>Asset</th><th>Status</th></tr>";
            res.data.forEach(j=>{
                html+=`<tr><td>${j.JobID}</td><td>${j.AssetName}</td><td>${j.Status}</td></tr>`;
            });
            document.getElementById("jobTable").innerHTML=html;
        }
    });
}

if(sessionStorage.getItem("user")){
    loadMain();
}
</script>

</body>
</html>
